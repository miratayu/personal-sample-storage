pipeline {
  agent any

  environment {
    fileName = 'output.txt'
  }

  stages {
    stage('hello') {
      steps {
        def result = setup('hello world')
        writeFile(file: fileName, text: result)
      }
    }
    stage('archive artifacts') {
      steps {
        archiveArtifacts fileName
      }
    }
  }
}

def setup(text) {
  echo text
  return text
}